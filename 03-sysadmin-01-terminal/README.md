---
## Ответы на домашнее задание "3.1. Работа в терминале, лекция 1" 
---
                    
<strong>1. Установите средство виртуализации Oracle VirtualBox. Выполнено.</strong>  
<strong>2. Установите средство автоматизации Hashicorp Vagrant. Выполнено.</strong>  
<strong>3. Подготовьте удобный для дальнейшей работы терминал. Выполнено.</strong>   
<strong>4. С помощью файла конфигурации запустил Ubuntu 22.04 в VirtualBox посредством Vagrant:  Выполнено.</strong>  
run "Ubuntu 22.04 LTS"  from ubuntu/jammy64 Vagrant box. (https://app.vagrantup.com/ubuntu/boxes/jammy64)     
<strong>5. Какие ресурсы выделены по-умолчанию?</strong>       
CPU=2  
RAM=1024 Mb  
VRAM=16 Mb  
HDD=40 Gb   
<strong>Выполнено.</strong>  
<strong>6. Как добавить оперативной памяти или ресурсов процессора виртуальной машине?</strong>  
<strong>добавлены строки в конфиг. файл Vagrantfile</strong>   
  vb.memory = 3072  
  vb.cpus = 3  
end  
<strong>Выполнено.</strong>

<strong>7. Попрактикуйтесь в выполнении обсуждаемых команд в терминале Ubuntu через SSH</strong>  
<strong>Выполнено.</strong>  

<strong>8. Ознакомиться с разделами man bash:</strong>    
Какой переменной можно задать длину журнала history:       
<strong>HISTFILESIZE</strong>    
Максимальное количество строк, содержащееся в файле истории. Если этой переменной присвоено значение, файл истории, при необходимости, усекается, и будет содержать не больше, чем указанное количество строк.  
вывод значения переменной (echo $HISTFILESIZE)  
man bash line 734  
  
<strong>HISTSIZE</strong>     
Количество команд, которые необходимо запоминать в списке истории.  
вывод значения переменной (echo $HISTSIZE)   
man bash line 738    

<strong>Что делает директива ignoreboth в bash?</strong>    
Ignoreboth — не записывать команду, которая начинается с пробела, либо команду, которая дублирует предыдущую.   
Пример:    
export HISTCONTROL=ignoreboth    
<strong>Выполнено.</strong>  

<strong>9. В каких сценариях использования применимы скобки {} и на какой строчке man bash это описано?</strong>   
Bash предоставляет два способа сгруппировать список команд, которые должны выполняться как единое целое.  
Когда команды сгруппированы, перенаправления могут применяться ко всему списку команд. Например, вывод всех команд в списке может быть перенаправлен в один поток.  

()
( список )
Помещение списка команд в круглые скобки приводит к созданию среды подоболочки (см. Среда выполнения команд ), и каждая из команд в списке будет выполняться в этой подоболочке. Поскольку список выполняется в подоболочке, назначения переменных не остаются в силе после завершения подоболочки.

{}
{ список ; }
Помещение списка команд между фигурными скобками приводит к тому, что список выполняется в текущем контексте оболочки. Подоболочка не создается. Список с точкой с запятой (или новой строкой) обязателен.

Помимо создания подоболочки, между этими двумя конструкциями существует тонкая разница, обусловленная историческими причинами. Фигурные скобки — это reserved words, поэтому они должны быть отделены от списка с помощью blanks или других метасимволов оболочки. Круглые скобки обозначаются operators и распознаются оболочкой как отдельные токены, даже если они не отделены от списка пробелами.  

Источник: Command Grouping (Bash Reference Manual) - GNU.org  
https://www.gnu.org/software/bash/manual/bash.html  

https://www.gnu.org/software/bash/manual/html_node/Command-Grouping.html  

<strong>10. Основываясь на предыдущем вопросе, как создать однократным вызовом touch 100000 файлов? А получилось ли создать 300000? Если нет, то почему?</strong>   
touch {0..99999}.txt   <strong>Успех.</strong>     
Проверка:  
ls -l | grep txt | wc -l   
100000  

touch {0..300000}.txt <strong>Ошибка.</strong>      
Argument list too long  
В Linux максимальный объем пространства для аргументов команды составляет 1/4 доступного пространства стека. Таким образом, решение состоит в том, чтобы увеличить количество места, доступного для стека.  

Выполняем ulimit -s 65536  
touch {0..300000}.txt  <strong>Успех.</strong>    
Проверка:  
ls -l | grep txt | wc -l
300001  

<strong>11. В man bash поищите по /\[\[. Что делает конструкция [[ -d /tmp ]]</strong>  
С помощью данной конструкции проверим условие (наличие каталога /tmp).
Пример:  
if [[ -d /tmp ]]; then echo "каталог есть"; else echo "каталога нет"; fi   
<strong>Выполнено.</strong>   

<strong>12. Основываясь на знаниях о просмотре текущих (например, PATH) и установке новых переменных; командах, которые мы рассматривали, добейтесь в выводе type -a bash в виртуальной машине наличия первым пунктом в списке:</strong>    

type -a bash    
bash is /usr/bin/bash   
bash is /bin/bash   

Решение:    
sudo mkdir -p /tmp/new_path_directory && sudo cp /usr/bin/bash /tmp/new_path_directory (создаём каталог и копируем в него бинарный файл "bash")     
sudo vi /etc/environment (Добавил в начало строки PATH="/tmp/new_path_directory:/) и перелогинился  
    
Результат:  
type -a bash    
bash is /tmp/new_path_directory/bash    
bash is /usr/bin/bash   
bash is /bin/bash   

Редактирование файлов ~/.bashrc и ~/.profile не давали требуемого результата:

type -a bash    
bash is /usr/bin/bash   
bash is /bin/bash   
bash is /tmp/new_path_directory/bash    
    
<strong>Выполнено.</strong> 
    
<strong>13. Чем отличается планирование команд с помощью batch и at?</strong>  
sudo apt install at  
man at  
    
<strong>at</strong>  
Команда принимает параметры в формате ЧЧ:ММ для выполнения задания в определенное время. (Если это время уже прошло, предполагается следующий день.) Вы также может указать полночь, полдень или время чаепития 4 часа дня ;-). (Перевод man at)   

<strong>batch</strong>  
Вполняет команды, когда позволяют уровни загрузки системы; другими словами, когда средняя нагрузка падает ниже 1,5 или указанного значения. (Перевод man at)   
<strong>Выполнено.</strong>  
 
<strong>14. Завершите работу виртуальной машины чтобы не расходовать ресурсы компьютера и/или батарею ноутбука.</strong>  
vagrant halt    
<strong>Выполнено.</strong>   

