---
## Ответы на домашнее задание "3.3. Операционные системы, лекция 1" 
---
                    
<strong>1. Какой системный вызов делает команда cd?</strong>  
    
strace /bin/bash -c 'cd /tmp' > strace.log 2>&1; cat strace.log | grep -w chdir       

Ответ:  
chdir("/tmp") = 0   
    
<strong>2. Используя strace выясните, где находится база данных file...</strong>   

man magic     
описание    
На этой странице руководства задокументирован формат magic files, используемый командой file(1) версии 5.39. Команда file(1) определяет тип файла
используя, среди прочих тестов, тест на наличие в файле определенных “магических шаблонов”. База данных этих “магических шаблонов” обычно находится в
двоичном файле в /usr/share/misc/magic.mgc или в каталоге файлов фрагментов магических шаблонов с исходным текстом в /usr/share/misc/magic. Конкретная база данных определяет, какие шаблоны должны быть проверены, какое сообщение или тип MIME для печати, если обнаружен определенный шаблон, и дополнительную информацию для извлечения из досье.     
    
strace file 2&> tmp.txt; cat tmp.txt | grep magic.mgc   
    
stat("/home/vagrant/.magic.mgc", 0x7ffe570aa7e0) = -1 ENOENT (Нет такого файла или каталога)    
openat(AT_FDCWD, "/etc/magic.mgc", O_RDONLY) = -1 ENOENT (Нет такого файла или каталога)    
openat(AT_FDCWD, "/usr/share/misc/magic.mgc", O_RDONLY) = 3     
    
ответ: /usr/share/misc/magic.mgc    
    
<strong>3. Основываясь на знаниях о перенаправлении потоков предложите способ обнуления открытого удаленного файла</strong>    
Запускаю процесс (PID=1416) пинга с выводом результатов в ping.log      
ping 192.168.1.1 >> ping.log &      
удаляю ping.log (rm ping.log)   
проверяю открытые процессом файлы       
sudo lsof -p 1416 | grep deleted        
ping    1416 vagrant    1w   REG    8,1    14942 17655 /home/vagrant/ping.log (deleted)     
Узнаю файловый дескриптор        
sudo ls -la /proc/1416/fd   
l-wx------ 1 root    root    64 Jun 29 16:52 1 -> '/home/vagrant/ping.log (deleted)'       
обнуляю удалённый файл:         
cat /dev/null | sudo tee /proc/1416/fd/1    
ping    1416 vagrant    1w   REG    8,1      10 17655 /home/vagrant/ping.log (deleted)  
размер удалённого файла обнулился   
Процесс остался в рабочем состоянии.    
    
<strong>4. Занимают ли зомби-процессы какие-то ресурсы в ОС (CPU, RAM, IO)?</strong>   

Зомби-процессы каких-либо ресурсов не занимают, кроме информации в списке процессов.    
    
<strong>5. На какие файлы вы увидели вызовы группы open за первую секунду работы утилиты?</strong>      

<strong>6. Какой системный вызов использует uname -a?</strong>       
    
<strong>7. Чем отличается последовательность команд через ; и через && в bash? Есть ли смысл использовать в bash &&, если применить set -e?</strong>        
    
<strong>8. Из каких опций состоит режим bash set -euxo pipefail и почему его хорошо было бы использовать в сценариях?</strong>  
    
<strong>9. Используя -o stat для ps, определите, какой наиболее часто встречающийся статус у процессов в системе.</strong>  
    
