# Домашнее задание к занятию "5. Оркестрация кластером Docker контейнеров на примере Docker Swarm"

---

## Задача 1

### Решение     
#### В чём отличие режимов работы сервисов в Docker Swarm кластере: replication и global?
В механизмах деплоя и распределения сервисов внутри кластера Docker Swarm.

**replication** - Задаётся определённое кол-во экземпляров сервиса, после чего Swarm сам решает на какие из доступных воркеров задеплоить указанное кол-во сервисов.

***global*** - Разворачивается по одному экземпляру сервиса на каждую доступную в кластере ноду.

#### Какой алгоритм выбора лидера используется в Docker Swarm?  
В кластере Docker Swarm при выборе лидера используется алгоритм "Raft"  
#### Цитаты с wiki:     
Raft — алгоритм для решения задач консенсуса в сети ненадёжных вычислений.      
Raft обеспечивает безопасную и эффективную реализацию машины состояний поверх кластерной вычислительной системы.    

#### Особенности алгоритма Raft
- Чёткое разделение фаз. Raft предлагает декомпозицию задачи управления кластером на несколько слабо связанных подзадач, основные из которых: выбор лидера (голосование) и репликация протоколов. Каждая из этих задач допускает более детальное разделение. Это упрощает понимание алгоритма и снижает риск ошибок при его реализации.       

- Явно выделенный лидер. Raft предполагает, что на кластере всегда существует явно выделенный лидер. Только этот лидер отправляет новые записи на другие узлы кластера. Таким образом, остальные узлы следуют за лидером и не взаимодействуют между собой (за исключением фазы голосования). Если внешний клиент подключается к кластеру через обычный узел, то все его запросы перенаправляются лидеру и только оттуда приходят на узлы.  

- Протоколы работы не могут содержать пропусков. То есть записи добавляются строго последовательно. Это накладывает некоторые ограничения, по сравнению с Паксос, но позволяет очень сильно упростить алгоритм. Кроме того, специфика прикладных задач, чаще всего, не позволяет корректно работать с протоколами, содержащими пропуски. То, что Паксос допускает возникновение таких пропусков, зачастую является недостатком Паксос, с которым очень трудно бороться.  

- Изменение размера кластера. Raft позволяет легко менять конфигурацию кластера, не останавливая работы: добавлять или удалять узлы.  

#### Что такое Overlay Network? 
В контексте Docker Swarm - это сеть для "служебного" трафика между менеджерами и воркерами.     
#### Цитаты с docs.docker.com (перевон яндекс)       

overlay - Сетевой драйвер создает распределенную сеть среди нескольких хостов-демонов Docker. Эта сеть располагается поверх (перекрывает) сети, специфичные для хоста, позволяя подключенным к ней контейнерам (включая служебные контейнеры swarm) безопасно обмениваться данными при включенном шифровании. Docker прозрачно обрабатывает маршрутизацию каждого пакета к правильному хосту-демону Docker и правильному контейнеру назначения и обратно.
- При инициализации роя или присоединении узла Docker к существующему рою на этом узле Docker создаются две новые сети:
вызываемая оверлейная сетьingress, которая обрабатывает трафик управления и данных, связанный с роевыми службами. Когда вы создаете службу swarm и не подключаете ее к определяемой пользователем оверлейной сети, она подключается к ingressсети по умолчанию.
называется мостовая сеть docker_gwbridge, которая соединяет отдельного демона Docker с другими демонами, участвующими в рое.    



## Задача 2

Создать ваш первый Docker Swarm кластер в Яндекс.Облаке

Для получения зачета, вам необходимо предоставить скриншот из терминала (консоли), с выводом команды:
```
docker node ls
```

## Задача 3

Создать ваш первый, готовый к боевой эксплуатации кластер мониторинга, состоящий из стека микросервисов.

Для получения зачета, вам необходимо предоставить скриншот из терминала (консоли), с выводом команды:
```
docker service ls
```

## Задача 4 (*)

Выполнить на лидере Docker Swarm кластера команду (указанную ниже) и дать письменное описание её функционала, что она делает и зачем она нужна:
```
